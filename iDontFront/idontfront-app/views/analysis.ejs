<%- include("../server-scripts/utilities") %>
<% let twitchUrl = "https://twitch.tv/videos/" + vod.id %>

<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale = 1.0">
        <title> <%= channel %> </title>
        <link rel="stylesheet" type="text/css" href="/fonts.css">
        <link rel="stylesheet" type="text/css" href="/styles.css">
        <link rel="stylesheet" type="text/css" href="/vod.css">
        <link rel="stylesheet" type="text/css" href="/styles-mobile.css">
        <link rel="stylesheet" type="text/css" href="/styles-desktop.css">
        <script src="/scripts.js"></script>
    </head>    
    <body>
        <style>
            figure {
                margin: 0;
            }
            #word-count-graph [font-family='hacky-selector-text'] text {
                display: none;
            }            
            #word-count-graph [font-family='hacky-selector-text'] text.on {
                display: inline;
            }
            #word-count-graph rect.on {
                filter: saturate(200%);
                stroke: black;
            }
            #word-count-graph [aria-label*="label"][aria-label*="y-axis"] {
                font-size: 15px;
            }
            #word-count-graph [aria-label*="label"][aria-label*="x-axis"] {
                font-size: 15px;
            }
            figure svg {
                margin-left: auto;
                margin-right: auto;
            }
        </style>
        
        
        <div> <%- wordcloud %></div>


        <%
            console.log("theSvg")
            // console.log(theSvg)
            // console.log(JSON.stringify(theSvg, null, 2));        
        %>
        <div> <%- theSvg %></div>
        <script>
            let figure = document.querySelector("#word-count-graph")
            let rects = figure.querySelectorAll("rect")
            let tooltips = document.querySelectorAll("#word-count-graph [font-family='hacky-selector-text'] text")
            for (let i=0; i < rects.length; i++) {
                rects[i].addEventListener("mouseenter", (e) => {
                    tooltips[i].classList.add("on")
                    rects[i].classList.add("on")
                })
                rects[i].addEventListener("mouseleave", (e) => {
                    tooltips[i].classList.remove("on")
                    rects[i].classList.remove("on")
                })
            }
        </script>

    </body>
</html>
